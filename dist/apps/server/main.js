(()=>{"use strict";var e={636:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppModule=void 0;const o=r(752),i=r(481),a=r(793),n=r(385),s=r(17),d=r(323),l=r(58),c=r(1),_=r(576),p=r(518),u=r(149);let y=class{};y=(0,o.__decorate)([(0,i.Module)({imports:[a.ConfigModule.forRoot(),n.ServeStaticModule.forRoot({rootPath:(0,s.join)(__dirname,"..","client")}),u.ScheduleModule.forRoot(),d.StorageModule,_.EventLoggerModule,l.AuthModule,c.UsersModule,p.TelegramHelperBotModule],controllers:[],providers:[]})],y),t.AppModule=y},58:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(752);(0,o.__exportStar)(r(540),t),(0,o.__exportStar)(r(500),t),(0,o.__exportStar)(r(965),t)},70:(e,t,r)=>{var o,i,a,n,s,d;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthController=void 0;const l=r(752),c=r(481),_=r(860),p=r(965),u=r(500),y=r(984),g=r(323),v=r(732),m=r(702);let f=class{constructor(e){this.authService=e}signIn(e,t){return(0,l.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.authService.checkEmailAndPassword(e.email,e.password),o=this.authService.encryptJwt(r);t.setHeader("Authorization",`Bearer ${o}`),t.send({token:o,user:r}),t.end()}))}signUp(e){return(0,l.__awaiter)(this,void 0,void 0,(function*(){return yield g.UserEntity.createUser(e.email,e.name,e.password)}))}getUser(e){return e}};(0,l.__decorate)([(0,c.Post)("sign-in"),(0,l.__param)(0,(0,c.Body)()),(0,l.__param)(1,(0,c.Res)()),(0,l.__metadata)("design:type",Function),(0,l.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==p.SignInDto&&p.SignInDto)?o:Object,"function"==typeof(i=void 0!==_.Response&&_.Response)?i:Object]),(0,l.__metadata)("design:returntype",Promise)],f.prototype,"signIn",null),(0,l.__decorate)([(0,c.Post)("sign-up"),(0,l.__param)(0,(0,c.Body)()),(0,l.__metadata)("design:type",Function),(0,l.__metadata)("design:paramtypes",["function"==typeof(a=void 0!==v.SignUpDto&&v.SignUpDto)?a:Object]),(0,l.__metadata)("design:returntype",Promise)],f.prototype,"signUp",null),(0,l.__decorate)([(0,c.Get)("current-user"),(0,l.__param)(0,(0,u.CurrentUser)()),(0,l.__metadata)("design:type",Function),(0,l.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==m.UserInterface&&m.UserInterface)?n:Object]),(0,l.__metadata)("design:returntype","function"==typeof(s=void 0!==m.UserInterface&&m.UserInterface)?s:Object)],f.prototype,"getUser",null),f=(0,l.__decorate)([(0,c.Controller)("auth"),(0,l.__metadata)("design:paramtypes",["function"==typeof(d=void 0!==y.AuthService&&y.AuthService)?d:Object])],f),t.AuthController=f},545:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthMiddleware=void 0;const i=r(752),a=r(481),n=r(984),s=r(323);let d=class{constructor(e){this.authService=e}use(e,t,r){var o;return(0,i.__awaiter)(this,void 0,void 0,(function*(){const i=e.headers.Authorization;if(a.Logger.log(i),!i)throw new a.UnauthorizedException;const n=String(i).replace("Bearer ",""),d=this.authService.decryptJwt(n);if(!(null===(o=null==d?void 0:d.user)||void 0===o?void 0:o.email))throw new a.UnauthorizedException;let l=d.user;if(Date.now()>Number(String(d.exp)+"000")){l=yield s.UserEntity.getUserByEmail(d.user.email);const e=this.authService.encryptJwt(l);t.setHeader("Authorization",`Bearer ${e}`)}e.user=l,r()}))}};d=(0,i.__decorate)([(0,a.Injectable)(),(0,i.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==n.AuthService&&n.AuthService)?o:Object])],d),t.AuthMiddleware=d},540:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthModule=void 0;const o=r(752),i=r(481),a=r(399),n=r(70),s=r(545),d=r(323),l=r(984),c=r(64);let _=class{configure(e){e.apply(s.AuthMiddleware).exclude({path:"api/auth/sign-in",method:i.RequestMethod.POST},{path:"api/users",method:i.RequestMethod.POST}).forRoutes({path:"*",method:i.RequestMethod.ALL})}};_=(0,o.__decorate)([(0,i.Module)({imports:[a.TypeOrmModule.forFeature([d.UserEntity,d.UserPasswordEntity]),c.JwtModule.register({secret:process.env.JWT_SECRET,signOptions:{expiresIn:"180s"}})],controllers:[n.AuthController],providers:[l.AuthService]})],_),t.AuthModule=_},984:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthService=void 0;const i=r(752),a=r(481),n=r(323),s=r(64);let d=class{constructor(e){this.jwtService=e}checkEmailAndPassword(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const r=yield n.UserEntity.findOne({where:{email:e}});if(!r)throw new a.UnauthorizedException(`${e} не зарегистрирован!`,"AuthLocalStrategy.validate()");if(!(yield n.UserPasswordEntity.isPasswordOfUser(r,t)))throw new a.UnauthorizedException("Неверный пароль!","AuthLocalStrategy.validate()");if(!r.isActive)throw new a.ForbiddenException("Доступ запрещен!","AuthLocalStrategy.validate()");return r}))}encryptJwt(e){const t={user:e};return this.jwtService.sign(t)}decryptJwt(e){return this.jwtService.verify(e)}};d=(0,i.__decorate)([(0,a.Injectable)(),(0,i.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==s.JwtService&&s.JwtService)?o:Object])],d),t.AuthService=d},500:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentUser=void 0;const o=r(481);t.CurrentUser=(0,o.createParamDecorator)((e=>e.switchToHttp().getRequest().user))},965:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SignInDto=void 0;const o=r(752),i=r(849);class a{}(0,o.__decorate)([(0,i.IsEmail)(),(0,o.__metadata)("design:type",String)],a.prototype,"email",void 0),(0,o.__decorate)([(0,i.IsString)(),(0,i.Length)(1,64),(0,o.__metadata)("design:type",String)],a.prototype,"password",void 0),t.SignInDto=a},732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SignUpDto=void 0;const o=r(752),i=r(849);class a{}(0,o.__decorate)([(0,i.IsEmail)(),(0,o.__metadata)("design:type",String)],a.prototype,"email",void 0),(0,o.__decorate)([(0,i.IsString)(),(0,i.Length)(1,255),(0,o.__metadata)("design:type",String)],a.prototype,"name",void 0),(0,o.__decorate)([(0,i.IsString)(),(0,i.Length)(1,64),(0,o.__metadata)("design:type",String)],a.prototype,"password",void 0),t.SignUpDto=a},702:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),(0,r(752).__exportStar)(r(117),t)},117:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},576:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(752);(0,o.__exportStar)(r(977),t),(0,o.__exportStar)(r(187),t),(0,o.__exportStar)(r(301),t)},301:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerRecordDto=void 0;const i=r(752),a=r(323),n=r(849);class s{}(0,i.__decorate)([(0,n.IsEnum)(a.RecordTypes),(0,i.__metadata)("design:type","function"==typeof(o=void 0!==a.RecordTypes&&a.RecordTypes)?o:Object)],s.prototype,"type",void 0),(0,i.__decorate)([(0,n.IsString)(),(0,i.__metadata)("design:type",String)],s.prototype,"message",void 0),(0,i.__decorate)([(0,n.IsOptional)(),(0,n.IsString)(),(0,i.__metadata)("design:type",String)],s.prototype,"context",void 0),t.EventLoggerRecordDto=s},410:(e,t,r)=>{var o,i,a;Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerController=void 0;const n=r(752),s=r(481),d=r(323),l=r(301);let c=class{postRecord(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield d.EventLoggerRecordEntity.addRecord(e.type,e.message,e.context)}))}getRecords(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield d.EventLoggerRecordEntity.find()}))}};(0,n.__decorate)([(0,s.Post)("records"),(0,n.__param)(0,(0,s.Body)()),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==l.EventLoggerRecordDto&&l.EventLoggerRecordDto)?o:Object]),(0,n.__metadata)("design:returntype","function"==typeof(i="undefined"!=typeof Promise&&Promise)?i:Object)],c.prototype,"postRecord",null),(0,n.__decorate)([(0,s.Get)("records"),(0,n.__metadata)("design:type",Function),(0,n.__metadata)("design:paramtypes",[]),(0,n.__metadata)("design:returntype","function"==typeof(a="undefined"!=typeof Promise&&Promise)?a:Object)],c.prototype,"getRecords",null),c=(0,n.__decorate)([(0,s.Controller)("event-logger")],c),t.EventLoggerController=c},977:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerModule=void 0;const o=r(752),i=r(481),a=r(399),n=r(323),s=r(410),d=r(187);let l=class{};l=(0,o.__decorate)([(0,i.Module)({imports:[a.TypeOrmModule.forFeature([n.EventLoggerRecordEntity])],controllers:[s.EventLoggerController],providers:[d.EventLoggerService],exports:[d.EventLoggerService]})],l),t.EventLoggerModule=l},187:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerService=void 0;const o=r(752),i=r(481),a=r(323);let n=class extends i.ConsoleLogger{stdout(e,t){console.log("EVENT LOGGER"),console.log("timestamp: "+(new Date).toISOString()),console.log("context: "+t),console.log("message: "+e),console.log()}log(e,t){this.stdout(e,t),a.EventLoggerRecordEntity.addRecord(a.RecordTypes.log,e,t)}warn(e,t){this.stdout(e,t),a.EventLoggerRecordEntity.addRecord(a.RecordTypes.warn,e,t)}erroe(e,t){this.stdout(e,t),a.EventLoggerRecordEntity.addRecord(a.RecordTypes.error,e,t)}verbose(e,t){this.stdout(e,t),a.EventLoggerRecordEntity.addRecord(a.RecordTypes.verbose,e,t)}debug(e,t){this.stdout(e,t),a.EventLoggerRecordEntity.addRecord(a.RecordTypes.debug,e,t)}};n=(0,o.__decorate)([(0,i.Injectable)()],n),t.EventLoggerService=n},323:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(752);(0,o.__exportStar)(r(4),t),(0,o.__exportStar)(r(296),t),(0,o.__exportStar)(r(244),t),(0,o.__exportStar)(r(374),t),(0,o.__exportStar)(r(434),t),(0,o.__exportStar)(r(501),t)},434:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.EventLoggerRecordEntity=t.RecordTypes=void 0;const i=r(752),a=r(250);var n;!function(e){e.log="log",e.warn="warn",e.error="error",e.verbose="verbose",e.debug="debug"}(n=t.RecordTypes||(t.RecordTypes={}));let s=o=class extends a.BaseEntity{static addRecord(e,t,r){return(0,i.__awaiter)(this,void 0,void 0,(function*(){let i=new o;return i.type=e,i.message=t,i.context=null!=r?r:null,i=yield this.save(i),i}))}};(0,i.__decorate)([(0,a.PrimaryGeneratedColumn)(),(0,i.__metadata)("design:type",Number)],s.prototype,"id",void 0),(0,i.__decorate)([(0,a.CreateDateColumn)(),(0,i.__metadata)("design:type",String)],s.prototype,"timestamp",void 0),(0,i.__decorate)([(0,a.Column)({type:"varchar",nullable:!1,enum:n}),(0,i.__metadata)("design:type",String)],s.prototype,"type",void 0),(0,i.__decorate)([(0,a.Column)({type:"varchar",nullable:!1}),(0,i.__metadata)("design:type",String)],s.prototype,"message",void 0),(0,i.__decorate)([(0,a.Column)({type:"varchar",nullable:!0}),(0,i.__metadata)("design:type",String)],s.prototype,"context",void 0),s=o=(0,i.__decorate)([(0,a.Entity)()],s),t.EventLoggerRecordEntity=s},374:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RoleEntity=void 0;const o=r(752),i=r(250),a=r(849),n=r(296);let s=class extends i.BaseEntity{};(0,o.__decorate)([(0,i.PrimaryGeneratedColumn)(),(0,o.__metadata)("design:type",Number)],s.prototype,"id",void 0),(0,o.__decorate)([(0,a.IsString)(),(0,a.Length)(1,50),(0,i.Column)({type:"varchar",length:50,unique:!0,nullable:!1}),(0,o.__metadata)("design:type",String)],s.prototype,"title",void 0),(0,o.__decorate)([(0,i.ManyToMany)((()=>n.UserEntity),(e=>e.roles)),(0,o.__metadata)("design:type",Array)],s.prototype,"users",void 0),s=(0,o.__decorate)([(0,i.Entity)("Roles")],s),t.RoleEntity=s},501:(e,t,r)=>{var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TeleramUpdateEntity=void 0;const a=r(752),n=r(250);let s=o=class extends n.BaseEntity{static addRecord(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){let t=new o;return t.message=e,t=yield this.save(t),t}))}};(0,a.__decorate)([(0,n.PrimaryGeneratedColumn)(),(0,a.__metadata)("design:type",String)],s.prototype,"id",void 0),(0,a.__decorate)([(0,n.CreateDateColumn)(),(0,a.__metadata)("design:type","function"==typeof(i="undefined"!=typeof Date&&Date)?i:Object)],s.prototype,"timestamp",void 0),(0,a.__decorate)([(0,n.Column)({type:"varchar"}),(0,a.__metadata)("design:type",String)],s.prototype,"message",void 0),s=o=(0,a.__decorate)([(0,n.Entity)("Telegram_update")],s),t.TeleramUpdateEntity=s},244:(e,t,r)=>{var o,i;Object.defineProperty(t,"__esModule",{value:!0}),t.UserPasswordEntity=void 0;const a=r(752),n=r(250),s=r(38),d=r(296),l=r(481);let c=o=class extends n.BaseEntity{static setPassword(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){if(t.length<8||t.length>64)throw new l.BadRequestException("Длина пароля должна быть от 8 до 64 символов!","UserPasswordEntity.setPassword()");let r=yield this.findOne({where:{user:e}});if(r)return r.passwordHashed=yield s.hash(t),void(yield this.save(r));r=new o,r.user=e,r.passwordHashed=yield s.hash(t)}))}static isPasswordOfUser(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.findOne({where:{user:e}});return!!r&&(yield s.verify(r.passwordHashed,t))}))}};(0,a.__decorate)([(0,n.PrimaryGeneratedColumn)(),(0,a.__metadata)("design:type",Number)],c.prototype,"id",void 0),(0,a.__decorate)([(0,n.OneToOne)((()=>d.UserEntity),(e=>e.password)),(0,n.JoinColumn)(),(0,a.__metadata)("design:type","function"==typeof(i=void 0!==d.UserEntity&&d.UserEntity)?i:Object)],c.prototype,"user",void 0),(0,a.__decorate)([(0,n.Column)({type:"varchar",length:512,nullable:!1}),(0,a.__metadata)("design:type",String)],c.prototype,"passwordHashed",void 0),c=o=(0,a.__decorate)([(0,n.Entity)("User_password")],c),t.UserPasswordEntity=c},296:(e,t,r)=>{var o,i,a,n;Object.defineProperty(t,"__esModule",{value:!0}),t.UserEntity=void 0;const s=r(752),d=r(250),l=r(849),c=r(481),_=r(244),p=r(374);let u=o=class extends d.BaseEntity{static createUser(e,t,r){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(c.Logger.log("Создание нового пользователя.",`UserEntity.createUser(${e}, ${t})`),yield this.findOne({where:{email:e}}))throw c.Logger.warn(`${e} занят!`,`UserEntity.createUser(${e}, ${t})`),new c.BadRequestException(`${e} занят!`);const i=yield this.count({where:{name:t}});let a=new o;a.email=e,a.name=i?`${t} - ${i+1}`:t;const n=yield(0,l.validate)(a);if(n.length)throw c.Logger.warn(`${n}`,`UserEntity.createUser(${e}, ${t})`),new c.BadRequestException(n);a=yield this.save(a);try{yield _.UserPasswordEntity.setPassword(a,r)}catch(r){throw c.Logger.warn("Пароль не прошел валидацию! Создание пользователя прервано!",`UserEntity.createUser(${e}, ${t})`),yield this.delete(a),new c.BadRequestException(r)}if(1===(yield this.count())){c.Logger.log("Создан первый пользователь приложения.",`UserEntity.createUser(${e}, ${t})`),c.Logger.log("Инициализируем ролевую модель и назначаем администратора!",`UserEntity.createUser(${e}, ${t})`);let r=new p.RoleEntity;r.title="admin",r=yield p.RoleEntity.save(r),c.Logger.log('Создана роль "Администратор".',`UserEntity.createUser(${e}, ${t})`);const o=new p.RoleEntity;o.title="user",yield p.RoleEntity.save(o),c.Logger.log('Создана роль "Пользователь".',`UserEntity.createUser(${e}, ${t})`),a.roles=[r],yield this.save(a),c.Logger.log(`Пользователю ${t} присвоена роль "Администратор".`,`UserEntity.createUser(${e}, ${t})`)}const s=yield p.RoleEntity.findOne({where:{title:"user"}});return a.roles=[...a.roles,s],yield this.save(a),c.Logger.log(`Пользователю ${t} присвоена роль "Пользователь".`,`UserEntity.createUser(${e}, ${t})`),c.Logger.log(`Пользователь ${t} успешно зарегистрирован.`,`UserEntity.createUser(${e}, ${t})`),a}))}static getUserByEmail(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.findOne({where:{email:e}});if(!t)throw new c.UnauthorizedException;if(!(null==t?void 0:t.isActive))throw new c.ForbiddenException;return{email:t.email,name:t.name}}))}};(0,s.__decorate)([(0,l.IsEmail)(),(0,l.Length)(1,255),(0,d.PrimaryColumn)({type:"varchar",length:255,unique:!0}),(0,s.__metadata)("design:type",String)],u.prototype,"email",void 0),(0,s.__decorate)([(0,l.IsString)(),(0,l.Length)(1,255),(0,d.Column)({type:"varchar",length:255,unique:!0,nullable:!1}),(0,s.__metadata)("design:type",String)],u.prototype,"name",void 0),(0,s.__decorate)([(0,l.IsOptional)(),(0,l.IsBoolean)(),(0,d.Column)({type:"boolean",nullable:!1,default:!0}),(0,s.__metadata)("design:type",Boolean)],u.prototype,"isActive",void 0),(0,s.__decorate)([(0,d.CreateDateColumn)(),(0,s.__metadata)("design:type","function"==typeof(i="undefined"!=typeof Date&&Date)?i:Object)],u.prototype,"createTimestamp",void 0),(0,s.__decorate)([(0,d.UpdateDateColumn)(),(0,s.__metadata)("design:type","function"==typeof(a="undefined"!=typeof Date&&Date)?a:Object)],u.prototype,"updateTimestamp",void 0),(0,s.__decorate)([(0,d.OneToOne)((()=>_.UserPasswordEntity),(e=>e.user)),(0,s.__metadata)("design:type","function"==typeof(n=void 0!==_.UserPasswordEntity&&_.UserPasswordEntity)?n:Object)],u.prototype,"password",void 0),(0,s.__decorate)([(0,d.ManyToMany)((()=>p.RoleEntity),(e=>e.users)),(0,d.JoinTable)(),(0,s.__metadata)("design:type",Array)],u.prototype,"roles",void 0),u=o=(0,s.__decorate)([(0,d.Entity)("Users")],u),t.UserEntity=u},4:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StorageModule=void 0;const o=r(752),i=r(481),a=r(399),n=r(869);let s=class{};s=(0,o.__decorate)([(0,i.Module)({imports:[a.TypeOrmModule.forRoot(n.default)]})],s),t.StorageModule=s},518:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),(0,r(752).__exportStar)(r(692),t)},692:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TelegramHelperBotModule=void 0;const o=r(752),i=r(481),a=r(399),n=r(323),s=r(182),d=r(140);let l=class{};l=(0,o.__decorate)([(0,i.Module)({imports:[a.TypeOrmModule.forFeature([n.EventLoggerRecordEntity,n.TeleramUpdateEntity]),s.TelegrafModule.forRoot({token:String(process.env.HELPER_BOT_TOKEN)})],providers:[d.TelegramHelperBotService]})],l),t.TelegramHelperBotModule=l},140:(e,t,r)=>{var o,i,a,n;Object.defineProperty(t,"__esModule",{value:!0}),t.TelegramHelperBotService=void 0;const s=r(752),d=r(481),l=r(182),c=r(832),_=r(323);let p=class{startCommand(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){yield _.TeleramUpdateEntity.addRecord(JSON.stringify(e.update)),yield e.reply("Привет!"),yield e.reply("👋"),d.Logger.log("Новый чат!","TelegramHelperBotService.startCommand()"),yield e.tg.sendMessage(1040890736,"К боту подключился новый пользователь!")}))}messageCommand(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){yield _.TeleramUpdateEntity.addRecord(JSON.stringify(e.update)),d.Logger.log("Новое сообщение!","TelegramHelperBotService.messageCommand()"),yield e.reply("Привет!"),yield e.reply("👋"),setTimeout((()=>(0,s.__awaiter)(this,void 0,void 0,(function*(){yield e.reply("Сколько будет 2 + 2?",{reply_markup:{inline_keyboard:[[{text:"4",callback_data:"4"}],[{text:"8",callback_data:"8"}]]}})}))),1e3)}))}getMe(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){yield e.reply("Пинг просто АГОНЬ!!!")}))}onAnswer(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){if(d.Logger.log("Новое действие!","TelegramHelperBotService.onAnswer()"),"callback_query"in e.update){const t=e.update.callback_query,r="data"in t?t.data:null;yield e.reply("Тут надо подумать..."),yield e.reply("🤔"),yield e.tg.sendChatAction(1040890736,"typing"),"4"===r?(setTimeout((()=>(0,s.__awaiter)(this,void 0,void 0,(function*(){yield e.reply("Правильно!"),yield e.reply("🥳")}))),2500),setTimeout((()=>(0,s.__awaiter)(this,void 0,void 0,(function*(){yield e.reply("Теперь ты можешь попробовать попинговать меня. ;)")}))),5e3),setTimeout((()=>(0,s.__awaiter)(this,void 0,void 0,(function*(){yield e.reply('Я запингуюсь если отправить мне команду "ping".')}))),5e3)):setTimeout((()=>(0,s.__awaiter)(this,void 0,void 0,(function*(){yield e.reply("К сожалению это не верный ответ."),yield e.reply("🤪")}))),1e3)}}))}};(0,s.__decorate)([(0,l.Start)(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==c.Context&&c.Context)?o:Object]),(0,s.__metadata)("design:returntype",Promise)],p.prototype,"startCommand",null),(0,s.__decorate)([(0,l.On)("message"),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(i=void 0!==c.Context&&c.Context)?i:Object]),(0,s.__metadata)("design:returntype",Promise)],p.prototype,"messageCommand",null),(0,s.__decorate)([(0,l.Hears)("ping"),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(a=void 0!==c.Context&&c.Context)?a:Object]),(0,s.__metadata)("design:returntype",Promise)],p.prototype,"getMe",null),(0,s.__decorate)([(0,l.Action)(["4","8"]),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==c.Context&&c.Context)?n:Object]),(0,s.__metadata)("design:returntype",Promise)],p.prototype,"onAnswer",null),p=(0,s.__decorate)([(0,l.Update)(),(0,d.Injectable)()],p),t.TelegramHelperBotService=p},1:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(752);(0,o.__exportStar)(r(546),t),(0,o.__exportStar)(r(309),t)},309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateUserDto=void 0;const o=r(752),i=r(849);class a{}(0,o.__decorate)([(0,i.IsEmail)(),(0,o.__metadata)("design:type",String)],a.prototype,"email",void 0),(0,o.__decorate)([(0,i.IsString)(),(0,i.Length)(1,255),(0,o.__metadata)("design:type",String)],a.prototype,"name",void 0),(0,o.__decorate)([(0,i.IsString)(),(0,i.Length)(7,64),(0,o.__metadata)("design:type",String)],a.prototype,"password",void 0),t.CreateUserDto=a},310:(e,t,r)=>{var o,i,a,n;Object.defineProperty(t,"__esModule",{value:!0}),t.UsersController=void 0;const s=r(752),d=r(481),l=r(418),c=r(309);let _=class{constructor(e){this.usersService=e}createUser(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.usersService.createUser(e)}))}getAllUsers(){return(0,s.__awaiter)(this,void 0,void 0,(function*(){return yield this.usersService.findAllUsers()}))}};(0,s.__decorate)([(0,d.Post)(),(0,s.__param)(0,(0,d.Body)()),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",["function"==typeof(o=void 0!==c.CreateUserDto&&c.CreateUserDto)?o:Object]),(0,s.__metadata)("design:returntype","function"==typeof(i="undefined"!=typeof Promise&&Promise)?i:Object)],_.prototype,"createUser",null),(0,s.__decorate)([(0,d.Get)(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype","function"==typeof(a="undefined"!=typeof Promise&&Promise)?a:Object)],_.prototype,"getAllUsers",null),_=(0,s.__decorate)([(0,d.Controller)("users"),(0,s.__metadata)("design:paramtypes",["function"==typeof(n=void 0!==l.UsersService&&l.UsersService)?n:Object])],_),t.UsersController=_},546:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UsersModule=void 0;const o=r(752),i=r(481),a=r(399),n=r(323),s=r(323),d=r(310),l=r(418);let c=class{};c=(0,o.__decorate)([(0,i.Module)({imports:[a.TypeOrmModule.forFeature([n.UserEntity,n.UserPasswordEntity,s.RoleEntity])],controllers:[d.UsersController],providers:[l.UsersService]})],c),t.UsersModule=c},418:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UsersService=void 0;const o=r(752),i=r(481),a=r(323);let n=class{createUser(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return yield a.UserEntity.createUser(e.email,e.name,e.password)}))}findAllUsers(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){return a.UserEntity.find({relations:["roles"]})}))}};n=(0,o.__decorate)([(0,i.Injectable)()],n),t.UsersService=n},869:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(17);t.default={type:"postgres",url:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1},autoLoadEntities:!0,synchronize:!1,retryAttempts:1,cli:{migrationsDir:(0,o.join)(__dirname,"libs","storage","src","lib","migrations")},entities:[(0,o.join)(__dirname,"libs","storage","src","lib","entities","*.entity.{ts,js}"),(0,o.join)(__dirname,"libs","storage","src","lib","entities","**","*.entity.{ts,js}")],migrations:[(0,o.join)(__dirname,"libs","storage","src","lib","migrations","*.{ts,js}"),(0,o.join)(__dirname,"libs","storage","src","lib","migrations","**","*.{ts,js}")],subscribers:[(0,o.join)(__dirname,"libs","storage","src","lib","subscribers","*.{ts,js}"),(0,o.join)(__dirname,"libs","storage","src","lib","subscribers","**","*.{ts,js}")]}},481:e=>{e.exports=require("@nestjs/common")},793:e=>{e.exports=require("@nestjs/config")},143:e=>{e.exports=require("@nestjs/core")},64:e=>{e.exports=require("@nestjs/jwt")},149:e=>{e.exports=require("@nestjs/schedule")},385:e=>{e.exports=require("@nestjs/serve-static")},399:e=>{e.exports=require("@nestjs/typeorm")},38:e=>{e.exports=require("argon2")},849:e=>{e.exports=require("class-validator")},860:e=>{e.exports=require("express")},182:e=>{e.exports=require("nestjs-telegraf")},832:e=>{e.exports=require("telegraf")},752:e=>{e.exports=require("tslib")},250:e=>{e.exports=require("typeorm")},17:e=>{e.exports=require("path")}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0});const t=r(752),i=r(481),a=r(143),n=r(636),s=r(793);(function(){return(0,t.__awaiter)(this,void 0,void 0,(function*(){const e=yield a.NestFactory.create(n.AppModule),t=e.get(s.ConfigService).get("PORT");e.setGlobalPrefix("api"),e.useGlobalPipes(new i.ValidationPipe),yield e.listen(t),i.Logger.log(`Сервер запущен в режиме "production" на: http://localhost:${t}/api`)}))})().catch((e=>{i.Logger.error("При запуске сервера возникла ошибка:","main.boostrap()"),console.error(e)}))})();var i=exports;for(var a in o)i[a]=o[a];o.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
//# sourceMappingURL=main.js.map